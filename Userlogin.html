<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="">
	<meta name="author" content="">
	<title>Green Harvest </title>
	 <link rel="icon" href="images/logo.jpg">
	<!-- Bootstrap core CSS -->
	<link href="vendors/bootstrap/css/bootstrap.min.css" rel="stylesheet">


        <!-- Custom styles for this template -->
	<!-- Fontawesome CSS -->

	<link href="css/all.css" rel="stylesheet">
	<!-- Custom styles for this template -->
	<link href="css/style.css" rel="stylesheet">
<link href="css/signin.css" rel="stylesheet">
<link rel="stylesheet" href="css/ss.css">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</head>

<body class="text-center">
    <!-- Navigation -->
    <nav id="navbar" class="navbar"></nav>
    <!---nav-end-->

		<div class="full-title">
			<div class="container">
				<!-- Page Heading/Breadcrumbs -->
				<h1 class="mt-4 mb-3">

				</h1>
			</div>
		</div> 

<section class="container-fluid">
	<h1>User Page Login</h1>
</section>
<section id="Features"  class="s">
<form class="" action="success.html" method="post" id="loginForm" onsubmit="loginUser(event)">
    <div class="container-fluid" >

      <br>
      <div class="col-lg-12">
        <input type="email" class="form-control"id="email" placeholder="Email" required />
      </div>
  <br>
      <div class="col-lg-12">
        <input type="password" class="form-control"id="password" placeholder="Password" required />
      </div>
            <div class="col-50">
<br>
	<button class="btn btn-success" type="submit" href="success.html">LOGIN</button>
					<p class="mt-5 mb-3 text-muted">&copy; The AgriProducts</p>
                </div>
 </div>
  </form>
	</section>

<!---footer-->
<nav id="footer" class="footer"></nav>
<!-- Bootstrap core JavaScript -->

<script src="vendors/jquery/jquery.min.js"></script>
<script src="vendors/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="login.js" defer></script>
<script defer src="js/sign.js"></script>
  <script src="script.js"></script>
  <script>
    async function loginUser(event) {
      event.preventDefault();
  
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
  
      try {
        const response = await fetch("http://localhost:5000/api/users/login", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email, password }),
        });
  
        const result = await response.json();
        console.log("Login response:", result);
  
        if (response.ok) {
          // Optionally store user in localStorage
          localStorage.setItem("user", JSON.stringify(result.user));
          // Redirect on successful login
          window.location.href = "success.html";
        } else {
          alert(result.message || "Login failed. Please try again.");
        }
      } catch (error) {
        console.error("Login error:", error);
        alert("An error occurred. Please try again later.");
      }
    }
  </script>
   

</body>
</html>
