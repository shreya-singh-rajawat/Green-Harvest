<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title>Green Harvest </title>
	 <link rel="icon" href="images/logo.jpg">
	<!-- Bootstrap core CSS -->
	<link href="vendors/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="css/all.css" rel="stylesheet">
	<link href="css/style.css" rel="stylesheet">
	<link href="css/signin.css" rel="stylesheet">
	<link rel="stylesheet" href="css/ss.css">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>

<body class="text-center">
    <!-- Navigation -->
    <nav id="navbar" class="navbar"></nav>
    <!---nav-end-->

    <div class="full-title">
        <div class="container">
            <!-- Page Heading/Breadcrumbs -->
            <h1 class="mt-4 mb-3">

            </h1>
        </div>
    </div> 


<section class="container-fluid">

<h1>Sign Up</h1>
</section>
<section id="Features"  class="s">
<form  action="success.html" class="form-signin" method="post" id="signupForm" onsubmit="registerUser(event)">
<div class="container-fluid" >
  <div class="col-lg-12">
      <input type="text" class="form-control" id="firstName" placeholder="First Name" required />
    </div>
  
<br>
    <div class="col-lg-12">
      <input type="text" class="form-control"id="lastName" placeholder="Last Name" required />
    </div>
  
 <br>
    <div class="col-lg-12">
      <input type="number" class="form-control" id="phone" placeholder="Phone Number" required />
    </div>

<br>
    <div class="col-lg-12">
      <input type="email" class="form-control"id="email" placeholder="Email" required />
    </div>
  

  <br>
    <div class="col-lg-12">
      <input type="password" class="form-control"id="password" placeholder="Password" required />
    </div>
  

  <br>
    <select id="role">
        <option value="customer">Customer</option>
        <option value="farmer">Farmer</option>
        <option value="Industrialist">Industrialist</option>

    </select><br>
    <br>
    <div class="d-grid gap-2 d-md-block">
    <button type="submit" class="btn btn-success">Sign Up</button>
    </div>
</div>
</form>

</section>

<!-----footer-->
<nav id="footer" class="footer"></nav>

<script src="vendors/jquery/jquery.min.js"></script>
    <script src="vendors/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script defer src="js/sign.js"></script>
    <script src="script.js"></script> 
  
<script>
  async function registerUser(event) {
    event.preventDefault();

    const userData = {
      firstname: document.getElementById('firstName').value,  
      lastname: document.getElementById('lastName').value,
      email: document.getElementById('email').value,
      phone: document.getElementById('phone').value,
      password: document.getElementById('password').value,
      role: document.getElementById('role').value
    };

    console.log("Sending data:", userData); // Debugging

    try {
      const response = await fetch('http://localhost:5000/api/users/register', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(userData)
      });

      const result = await response.json();
      console.log("Response from server:", result);

      if (response.ok) {
        // âœ… Redirect only after successful registration
        window.location.href = 'success.html';
      } else {
        alert(result.message || "Registration failed");
      }

    } catch (error) {
      console.error("Error:", error);
      alert("Registration failed due to an error.");
    }
  }
</script>

</body>
</html>